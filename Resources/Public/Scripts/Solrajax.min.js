!function(e,t,r){"use strict";var a=t.module("nx.solrajax",["ngSanitize","ui.bootstrap.datepicker","ui.bootstrap.typeahead","nx.angular.variables"]);a.config(["$routeProvider","nxConfigurationServiceProvider",function(e,t){e.when("/ajaxsearch/:path*",{controller:"SearchResultCtrl",templateUrl:t.value("nx.solrajax.searchresult.templateUrl"),resolve:{searchResponse:["$location","$http",function(e,t){return t.get(e.path(),{params:e.search()})}]}})}]),a.controller("SearchResultCtrl",["searchResponse","$http","$location","$scope","$rootScope","dateFilter",function(e,r,a,s,n,o){s.showFacetFilters=!1,s.loading=!1,s.suggestLoading=!1,s.q=e.data.search.q||"",s.facets=e.data.facets,s.results=e.data.result,s.search=e.data.search,s.typeFacet=function(){return t.isUndefined(s.facets.availableFacets)?!1:s.facets.availableFacets.filter(function(e){return e.label?"type"===e.label.toLowerCase():!1})[0]},s.autoSuggestion=function(e){return r.get(s.search.suggestUrl,{params:{q:e.toLowerCase()},cache:!0}).then(function(e){return e.data.results})},s.submitSearch=function(e){var r=s.suggestLoading&&t.isDefined(e)?e.val():this.q.name||this.q;a.path(s.search.url.replace("QUERY_STRING",r))},s.removeSearch=function(){a.path(s.search.url.replace("QUERY_STRING",""))},s.select=function(e){a.path(e)},s.selectDate=function(e){var t,r,s;t=e.start?o(e.start,"yyyyMMdd"):"*",r=e.end?o(e.end,"yyyyMMdd"):"*",s=e.start||e.end?decodeURI(e.url).replace(encodeURI("{filterValue}"),encodeURI(t+e.delimiter+r)):e.reseturl,a.path(s)},s.removeStartDate=function(e){e.start="",s.selectDate(e)},s.removeEndDate=function(e){e.end="",s.selectDate(e)},s.isDateSelected=function(){var e=!1;return t.forEach(s.facets.availableFacets,function(t){"queryGroup"!==t.type&&"dateRange"!==t.type||!t.active||(e=!0)}),e},s.loadPrev=function(){n.$broadcast("$solrajaxLoadMoreStart",s.results.prevLink),s.loading=!0,r.get(s.results.prevLink).success(function(e,r,a,o){n.$broadcast("$solrajaxLoadMoreSuccess",s.results.prevLink),s.results.prevLink=e.result.prevLink||"",t.forEach(e.result.resultDocuments.reverse(),function(e){s.results.resultDocuments.unshift(e)}),s.loading=!1}).error(function(e,t,r,a){n.$broadcast("$solrajaxLoadMoreError",s.results.prevLink),s.results.prevLink="",s.loading=!1})},s.loadNext=function(){n.$broadcast("$solrajaxLoadMoreStart",s.results.nextLink),s.loading=!0,r.get(s.results.nextLink,{cache:!0}).success(function(e,r,a,o){n.$broadcast("$solrajaxLoadMoreSuccess",s.results.nextLink),s.results.nextLink=e.result.nextLink||"",t.forEach(e.result.resultDocuments,function(e){s.results.resultDocuments.push(e)}),s.loading=!1}).error(function(e,t,r,a){n.$broadcast("$solrajaxLoadMoreError",s.results.nextLink),s.results.nextLink="",s.loading=!1})},s.isSiteActive=function(e){return s.search.site.selected===e},s.selectSite=function(e){t.isUndefined(s.search.site[e])||s.select(s.search.site[e])}}]),a.directive("nxBindResult",["$sce","$parse","$compile",function(e,t,r){return function(a,s,n){function o(){return(c(a)||"").toString()}s.addClass("ng-binding").data("$binding",n.nxBindResult);var c=t(n.nxBindResult);a.$watch(o,function i(){s.html(r(e.getTrustedHtml(e.trustAsHtml(c(a))))(a)||"")})}}])}(window,angular);
//# sourceMappingURL=./Solrajax.min.map